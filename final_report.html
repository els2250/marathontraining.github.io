<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Final Report</title>

<script src="site_libs/header-attrs-2.16/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="final_report.html">Final Report</a>
</li>
<li>
  <a href="descriptive_stats.html">Descriptive Statistics</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Exploratory Analyses
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Tab to nowhere</li>
  </ul>
</li>
<li>
  <a href="mailto:&lt;gw2442@cumc.columbia.edu; els2250@cumc.columbia.edu; hw2852@cumc.columbia.edu; ma4197@cumc.columbia.edu&gt;">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/els2250/marathontraining.github.io">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://www.strava.com/">
    <span class="fa fa-brands fa-person-running"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Final Report</h1>

</div>


<p><br/></p>
<div
id="motivation-provide-an-overview-of-the-project-goals-and-motivation."
class="section level4">
<h4>Motivation: Provide an overview of the project goals and
motivation.</h4>
<p>Running a marathon requires an immense amount of time, effort, and
dedication. First-time marathon runners are forced to make decisions
with little knowledge of what to expect. Being ill-prepared and
over-training are two common experiences that occur during training and
on race day. Emma, one of our group members, ran the New York City
Marathon (NYCM) this past fall, which was her first marathon. After
completing the marathon on November 6th, Emma was prepared to start
training for the next one. Therefore, we are interested in understanding
the impact of external factors, such as temperature, wind, elevation,
etc., on Emma’s speed and performance during the marathon, while also
considering how training changed over time in order to improve her
training for next marathon.</p>
<p><br/></p>
</div>
<div
id="related-work-anything-that-inspired-you-such-as-a-paper-a-web-site-or-something-we-discussed-in-class."
class="section level4">
<h4>Related Work: Anything that inspired you, such as a paper, a web
site, or something we discussed in class.</h4>
<p>This year, the NYCM was considered the hottest marathon since 1986.
With temperatures in the mid-70s for most of the race, participants were
encouraged to focus on hydrating and maintaining electrolytes in order
to maintain their speed and finish the race. Most runners - beginners
and experts alike - were struggling with the heat during race day,
causing adverse health outcomes and decreased performance (<a
href="https://www.runnersworld.com/news/a41956910/strava-data-2022-nyc-marathon/">Runner’s
World Article</a>). Emma’s experiences before and during the race
inspired us to investigate her marathon training data. During the
marathon, Emma felt the effects of the heat on her performance, and
watched numerous people collapse mid-race. Emma also had her own battles
with training prior to the marathon most likely due to
over-training.</p>
<p>Upon receiving Emma’s data from Strava.com, we noticed that the data
was clean and organized, allowing for easy generation of visuals. After
reviewing the data, we recognized that we could conduct analyses from
different vantage points, such as reviewing the average elements for
each run or using per-second data to generate interactive maps. Inspired
by our in-class work using <code>ggplot</code>, <code>plot.ly</code>,
and additional visualization techniques, we are able to comprehensively
investigate Emma’s training and race day data. Lastly, we hope to use
modeling to understand the interactions of different factors on Emma’s
performance, which will hopefully inform her training efforts in the
future.</p>
<p><br/></p>
</div>
<div
id="initial-questions-what-questions-are-you-trying-to-answer-how-did-these-questions-evolve-over-the-course-of-the-project-what-new-questions-did-you-consider-in-the-course-of-your-analysis"
class="section level4">
<h4>Initial Questions: What questions are you trying to answer? How did
these questions evolve over the course of the project? What new
questions did you consider in the course of your analysis?</h4>
<p><br/></p>
</div>
<div id="data-source-scraping-method-cleaning-etc."
class="section level4">
<h4>Data: Source, scraping method, cleaning, etc.</h4>
<p>Data was collected using the Garmin Forerunner 245 activity watch
from July 23, 2020 to November 6, 2022. Collected data was uploaded to
Strava.com after each activity. After granting permission, personal data
was downloaded from Strava.com. Summary data for each activity post was
saved in the form of a <code>.csv</code> file (imported using
<code>tidyverse</code>) and per-second data for each activity was
compiled and saved in a <code>.fit</code> file (imported using
<code>FITfileR</code>).</p>
<div id="importing-data" class="section level5">
<h5><em>Importing Data</em></h5>
<p>First, we imported the summary data of all of Emma’s training runs
from July 23, 2020 to November 6, 2022. In order to clean this data,
we:</p>
<ol style="list-style-type: decimal">
<li>Sorted data to include only information from the time that Emma
started training for the NYCM, which was on April 4, 2022</li>
<li>Selected the necessary variables</li>
</ol>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
## ✔ ggplot2 3.3.6      ✔ purrr   0.3.4 
## ✔ tibble  3.1.8      ✔ dplyr   1.0.10
## ✔ tidyr   1.2.0      ✔ stringr 1.4.1 
## ✔ readr   2.1.2      ✔ forcats 0.5.2 
## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>library(FITfileR)
library(dplyr)
library(patchwork)
library(leaflet)</code></pre>
<pre class="r"><code>training_summary &lt;- read_csv(&quot;activities/activities.csv&quot;) %&gt;% 
  janitor::clean_names() %&gt;%
  filter(activity_type == &quot;Run&quot;) %&gt;%
  select(activity_id, activity_date, activity_name, activity_description, elapsed_time_6, distance_7, max_heart_rate_8, relative_effort_9, max_speed, average_speed, elevation_gain, elevation_loss, max_grade, average_grade, max_cadence, average_cadence, average_heart_rate, calories, weather_temperature, dewpoint, humidity, wind_speed) %&gt;%
  filter(activity_id &gt;= 6910869137) %&gt;%
  separate(activity_date, c(&quot;month_date&quot;, &quot;year&quot;, &quot;time&quot;), sep = &quot;, &quot;) %&gt;%
  mutate(
    date = str_c(month_date, year, sep = &quot; &quot;),
    date = as.Date(date, format = &quot;%b%d%Y&quot;)
  ) %&gt;%
  select(-month_date, -year) %&gt;%
  mutate(
    elapsed_time_min = elapsed_time_6 / 60,
    distance_km = distance_7,
    max_heart_rate = max_heart_rate_8,
    relative_effort = relative_effort_9
  ) %&gt;%
  select(-elapsed_time_6, -distance_7, -max_heart_rate_8, -relative_effort_9)</code></pre>
<pre><code>## New names:
## Rows: 335 Columns: 84
## ── Column specification
## ──────────────────────────────────────────────────────── Delimiter: &quot;,&quot; chr
## (6): Activity Date, Activity Name, Activity Type, Activity Description,... dbl
## (49): Activity ID, Elapsed Time...6, Distance...7, Max Heart Rate...8, R... lgl
## (29): Commute...10, Athlete Weight, Bike Weight, Average Positive Grade,...
## ℹ Use `spec()` to retrieve the full column specification for this data. ℹ
## Specify the column types or set `show_col_types = FALSE` to quiet this message.
## • `Elapsed Time` -&gt; `Elapsed Time...6`
## • `Distance` -&gt; `Distance...7`
## • `Max Heart Rate` -&gt; `Max Heart Rate...8`
## • `Relative Effort` -&gt; `Relative Effort...9`
## • `Commute` -&gt; `Commute...10`
## • `Elapsed Time` -&gt; `Elapsed Time...15`
## • `Distance` -&gt; `Distance...17`
## • `Max Heart Rate` -&gt; `Max Heart Rate...30`
## • `Relative Effort` -&gt; `Relative Effort...37`
## • `Commute` -&gt; `Commute...50`</code></pre>
<pre class="r"><code>activity_summaries =
  training_summary %&gt;%
  select(activity_id, date, time, activity_name, activity_description)
tidy_training = 
  training_summary %&gt;%
  select(-activity_name, -activity_description) %&gt;%
  select(activity_id, date, time, distance_km, elapsed_time_min, max_speed, average_speed, max_heart_rate, average_heart_rate, relative_effort, everything()) %&gt;% 
  filter(date != &quot;2022-03-31&quot;, 
         date != &quot;2022-04-03&quot;)</code></pre>
<p>Since each Garmin activity was downloaded as an individual FIT file,
a function was created to iterate across the multiple activities and
compile a single data frame. As shown below, the function was created to
read each activity FIT file into R and pull out the records (which
included data on latitude and longitude, distance, speed, heart rate,
and cadence), and then each second of activity was merged into a single
data frame. This function was applied to a list of all file names. A
<code>for</code> loop was used to generate a list of data frames, and
then rows were merged using <code>bind_rows</code> to create the final
data frame, <code>marathon_df</code>.</p>
</div>
<div id="data-cleaning" class="section level5">
<h5><em>Data Cleaning</em></h5>
<p>After importing, the data frame was then cleaned to include
activities from the start of marathon training (March 31, 2022) to the
day of the New York City Marathon (November 6, 2022). Within the
‘activities’ data set, there were 335 observations and 84 variables. The
data was filtered to only include observations from ‘activity_type’ that
were classified as ‘Run’. From this, 22 variables were selected to be
included in this data set: activity_id, activity_date, activity_name,
activity_description, elapsed_time_6, distance_7, max_heart_rate_8,
relative_effort_9, max_speed, average_speed, elevation_gain,
elevation_loss, max_grade, average_grade, max_cadence, average_cadence,
average_heart_rate, calories, weather_temperature, dewpoint,
humidity,and wind_speed.</p>
<p>Due to Emma’s marathon training beginning March 31st, 2022, the
‘activity_id’ was used in order to filter any training prior to this.
Following this, the variable ‘activity_date’ was separated into two
variables:the date on which the run occurred (‘date’) as well as the
time when the run began (‘time’). The ‘elapsed_time_6’ variable was
converted from seconds to minutes (‘elapsed_time_min’). In addition to
this, the variables names for distance_7, max_heart_rate_8, and
relative_effort_9 were changed to distance_km, max_heart_rate, and
relative_effort.</p>
<p>A new data frame, ‘activities_summaries’ was created in order to
include the written accounts from each of Emma’s runs, including
variables ‘activity_name’ and ‘activity_description’.</p>
<p>The final cleaned data set, ‘tidy_training’, included 110
observations and 21 variables. Variables included were:activity_id,
date, time, distance_km, elapsed_time_min, max_speed, average_speed,
max_heart_rate, average_heart_rate, relative_effort, elevation_gain,
elevation_loss, max_grade, average_grade, max_cadence, averag_cadence,
calories, weather_temperature, dewpoint, humidity, and wind_speed.</p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>

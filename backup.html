<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Final Report</title>

<script src="site_libs/header-attrs-2.16/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/united.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="site_libs/leaflet-1.3.1/leaflet.js"></script>
<link href="site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="site_libs/proj4-2.6.2/proj4.min.js"></script>
<script src="site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="site_libs/leaflet-binding-2.1.1/leaflet.js"></script>
<script src="site_libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="site_libs/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="backup.html">Final Report</a>
</li>
<li>
  <a href="exploratory_analyses.html">Data Visualization</a>
</li>
<li>
  <a href="descriptive_stats.html">Interactive Map</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Models
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="models_speed.html">Regression Models: Speed</a>
    </li>
    <li>
      <a href="models_rel_effort.html">Regression Models: Relative Effort</a>
    </li>
  </ul>
</li>
<li>
  <a href="jfg.html">AJG</a>
</li>
<li>
  <a href="mailto:&lt;gw2442@cumc.columbia.edu; els2250@cumc.columbia.edu; hw2852@cumc.columbia.edu; ma4197@cumc.columbia.edu&gt;">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/els2250/marathontraining.github.io">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Final Report</h1>

</div>


<p><br/></p>
<p><img src="images/banner.png" /></p>
<div id="motivation" class="section level2">
<h2>Motivation</h2>
<p>Running a marathon requires an immense amount of time, effort, and
dedication. First-time marathon runners are forced to make decisions
with little knowledge of what to expect. Being ill-prepared and
over-training are two common experiences that occur during training and
on race day. Emma, one of our group members, ran the New York City
Marathon (NYCM) this past fall, which was her first marathon. After
completing the marathon on November 6th, Emma was prepared to start
training for the next one. Therefore, we are interested in understanding
the impact of external factors, such as temperature, wind, elevation,
etc., on Emma’s speed and performance during the marathon, while also
considering how training changed over time in order to improve her
training for the next marathon.</p>
<p><br/></p>
</div>
<div id="related-work" class="section level2">
<h2>Related Work</h2>
<p>This year, the NYCM was considered the hottest marathon since 1986.
With temperatures in the mid-70s for most of the race, participants were
encouraged to focus on hydrating and maintaining electrolytes in order
to maintain their speed and finish the race. Most runners - beginners
and experts alike - were struggling with the heat during race day,
causing adverse health outcomes and decreased performance (<a
href="https://www.runnersworld.com/news/a41956910/strava-data-2022-nyc-marathon/">Runner’s
World Article</a>). Emma’s experiences before and during the race
inspired us to investigate her marathon training data. During the
marathon, Emma felt the effects of the heat on her performance, and
watched numerous people collapse mid-race. Emma also had her own battles
with training prior to the marathon most likely due to
over-training.</p>
<p>Upon receiving Emma’s data from Strava.com, we noticed that the data
was clean and organized, allowing for easy generation of visuals. After
reviewing the data, we recognized that we could conduct analyses from
different vantage points, such as reviewing the average elements for
each run or using per-second data to generate interactive maps. Inspired
by our in-class work using <code>ggplot</code>, <code>plot.ly</code>,
and additional visualization techniques, we are able to comprehensively
investigate Emma’s training and race day data. Lastly, we hope to use
modeling to understand the interactions of different factors on Emma’s
performance, which will hopefully inform her training efforts in the
future.</p>
<p><br/></p>
</div>
<div id="initial-questions" class="section level2">
<h2>Initial Questions</h2>
<p>For the purposes of this project, we will be answering the following
questions:</p>
<ol style="list-style-type: decimal">
<li>What does Emma’s training schedule look like with respect to
environmental factors such as temperature, humidity, elevation,
etc.?</li>
<li>What are Emma’s optimal training conditions?</li>
<li>What are Emma’s most comfortable training distances?</li>
<li>How do environmental factors affect Emma’s performance? Are these
factors good predictors for her performance?</li>
</ol>
<p><br/></p>
</div>
<div id="data" class="section level2">
<h2>Data</h2>
<p>In preparation for data analysis, we will load the following
libraries:</p>
<ul>
<li><code>tidyverse</code></li>
<li><code>FITfileR</code></li>
<li><code>dplyr</code></li>
<li><code>patchwork</code></li>
<li><code>leaflet</code></li>
<li><code>modelr</code></li>
</ul>
<pre class="r"><code>library(tidyverse)
library(FITfileR)
library(dplyr)
library(patchwork)
library(leaflet)
library(modelr)</code></pre>
<p>Data was collected using the Garmin Forerunner 245 activity watch
from July 23, 2020 to November 6, 2022. Collected data was uploaded to
Strava.com after each activity. After granting permission, personal data
was downloaded from Strava.com. Summary data for each activity post was
saved in the form of a <code>.csv</code> file (imported using
<code>tidyverse</code>) and per-second data for each activity was
compiled and saved in a <code>.fit</code> file (imported using
<code>FITfileR</code>).</p>
<div id="importing-describing-raw-data" class="section level3">
<h3>Importing &amp; Describing Raw Data</h3>
<p>First, we imported the summary-level data of all of Emma’s training
runs from July 23, 2020 to November 6, 2022 using the
<code>read_csv</code> function.</p>
<pre class="r"><code>training_raw &lt;- read_csv(&quot;activities/activities.csv&quot;) %&gt;% 
  janitor::clean_names()</code></pre>
<p>The raw data contains <strong>335 observations</strong> and
<strong>84 variables</strong>. Variables include data regarding activity
date and type, trail/route information, equipment use, physical
responses to training (heart rate, cadence, etc.), and weather. As is,
these data were not tidy… Let’s tidy!</p>
</div>
<div id="data-cleaning" class="section level3">
<h3>Data Cleaning</h3>
<p>After importing, the data frame was then cleaned to include
activities from the start of marathon training (April 4, 2022) to the
day of the New York City Marathon (November 6, 2022). The data was
filtered to only include observations from <code>activity_type</code>
that were classified as ‘Run’. We selected 22 relevant variables
(summarized below).</p>
<p>Due to Emma’s marathon training beginning April 4th, 2022, the
<code>activity_id</code> was used in order to filter any training prior
to this. Following this, the variable <code>activity_date</code> was
separated into two variables: the date on which the run occurred
(<code>date</code>) as well as the time when the run began
(<code>time</code>). The <code>elapsed_time_6</code> variable was
converted from seconds to minutes (<code>elapsed_time_min</code>). In
addition to this, the variables names for <code>distance_7</code>,
<code>max_heart_rate_8</code>, and <code>relative_effort_9</code> were
changed to <code>distance_km</code>, <code>max_heart_rate</code>, and
<code>relative_effort.</code></p>
<p>A new data frame, <code>activities_summaries</code> was created in
order to include the written accounts from each of Emma’s runs,
including variables <code>activity_name</code> and
<code>activity_description</code>.</p>
<pre class="r"><code>training_summary = 
  training_raw %&gt;% 
  filter(activity_type == &quot;Run&quot;) %&gt;%
  select(activity_id, activity_date, activity_name, activity_description, elapsed_time_6, distance_7, max_heart_rate_8, relative_effort_9, max_speed, average_speed, elevation_gain, elevation_loss, max_grade, average_grade, max_cadence, average_cadence, average_heart_rate, calories, weather_temperature, dewpoint, humidity, wind_speed) %&gt;%
  filter(activity_id &gt;= 6910869137) %&gt;%
  separate(activity_date, c(&quot;month_date&quot;, &quot;year&quot;, &quot;time&quot;), sep = &quot;, &quot;) %&gt;%
  mutate(
    date = str_c(month_date, year, sep = &quot; &quot;),
    date = as.Date(date, format = &quot;%b%d%Y&quot;)
  ) %&gt;%
  select(-month_date, -year) %&gt;%
  mutate(
    elapsed_time_min = elapsed_time_6 / 60,
    distance_km = distance_7,
    max_heart_rate = max_heart_rate_8,
    relative_effort = relative_effort_9
  ) %&gt;%
  select(-elapsed_time_6, -distance_7, -max_heart_rate_8, -relative_effort_9)
activity_summaries =
  training_summary %&gt;%
  select(activity_id, date, time, activity_name, activity_description)

tidy_training = 
  training_summary %&gt;%
  select(-activity_name, -activity_description) %&gt;%
  select(activity_id, date, time, distance_km, elapsed_time_min, max_speed, average_speed, max_heart_rate, average_heart_rate, relative_effort, everything()) %&gt;% 
  filter(date != &quot;2022-03-31&quot;, 
         date != &quot;2022-04-03&quot;)</code></pre>
<p>The final cleaned data set, ‘tidy_training’, included <strong>108
observations</strong> and <strong>21 variables</strong>. The tidied
dataset contains the following variables and associated
characteristics:</p>
<ul>
<li><code>activity_id</code>: Unique activity identifier</li>
<li><code>date</code>: Date of activity (YYYY-MM-DD)</li>
<li><code>time</code>: Time of activity</li>
<li><code>distance_km</code>: Distance ran (km), mean = 8.9215741,
range</li>
<li><code>elapsed_time_min</code>: Time spent running in minutes, mean =
54.4388889</li>
<li><code>max_speed</code>: Maximum running speed (meters/second), mean
= 7.4808794</li>
<li><code>average_speed</code>: Average speed (meters/second) during the
activity, mean = 3.037298</li>
<li><code>max_heart_rate</code>: Maximum heart rate (beats per minute)
during the activity, mean = 176.4537037</li>
<li><code>average_heart_rate</code>: Average heart rate during the
activity, mean = 154.6877133</li>
<li><code>relative_effort</code>: Relative effort calculated using heart
rate data, mean = 95.462963</li>
<li><code>elevation_gain</code>: Elevation gained during the activity,
mean = 58.0976234</li>
<li><code>elevation_loss</code>: Elevation lost during the activity,
mean = 469.7619048</li>
<li><code>max_grade</code>: Maximum grade during the activity, mean =
24.2052355</li>
<li><code>average_grade</code>: Average grade during the activity, mean
= -3.0404352^{-4}</li>
<li><code>max_cadence</code>: Maximum cadence (steps per minute) during
the activity, mean = 89.1296296</li>
<li><code>average_cadence</code>: Average cadence (steps per minute)
during the activity, mean = 79.7518814</li>
<li><code>calories</code>: Calories burned during the activity, mean =
454.2592593</li>
<li><code>weather_temperature</code>: Temperature (Celsius) during the
activity, mean = 7.4808794</li>
<li><code>dewpoint</code>: Dew point during the activity, mean =
13.614</li>
<li><code>humidity</code>: Humidity (%) during the activity, mean =
0.7151765</li>
<li><code>wind_speed</code>: Wind speed in meters per second during the
activity, mean = 2.1948235</li>
</ul>
<p><br/></p>
</div>
</div>
<div id="exploratory-analysis" class="section level2">
<h2>Exploratory Analysis</h2>
<p>To first visualize Emma’s training schedule, we created a weekly
mileage plot illustrating her mileage (km) ran over her training period.
We then looked to investigate the optimal running length for her
training sessions using a density plot, as well as investigating the
relationship between temperature and average speed, average heart rate,
and relative effort. We then investigated the relationship between
humidity and average speed, average heart rate, and relative effort.
Finally, we plotted Emma’s NYCM racing path throughout NYC, including
average speed, heart rate, cadence, and altitude for each mile during
the race.</p>
<p>Note: data only includes Emma’s logged activities - rest days were
not included.</p>
<div id="mileage-over-time" class="section level3">
<h3>Mileage Over Time</h3>
<pre class="r"><code>tidy_training = tidy_training %&gt;% 
  mutate(week = as.numeric(strftime(date, format = &quot;%V&quot;)) - 13) %&gt;% 
  group_by(week) %&gt;%
  mutate(weekly_distance_km = sum(distance_km))

tidy_training %&gt;%
  ggplot(aes(x = week, y = weekly_distance_km)) +
  geom_point(color = c(&quot;#FFA500&quot;)) +
  geom_line(color = c(&quot;#FFA500&quot;)) + 
  labs(
    title = &quot;Weekly Distance Ran by Emma (km)&quot;,
    x = &quot;Week&quot;, 
    y = &quot;Distance (km)&quot;) + 
  scale_x_continuous(breaks = scales::pretty_breaks(n = 5)) + 
  scale_y_continuous(breaks = scales::pretty_breaks(n = 5)) +
  theme(axis.line = element_line(color = &quot;grey&quot;), 
        panel.background = element_blank(), 
        legend.position = &quot;none&quot;, 
        panel.grid.major = element_line(color = &quot;light grey&quot;, linetype = &quot;dashed&quot;),
        plot.title = element_text(hjust = 0.5))</code></pre>
<p><img src="backup_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Emma’s mileage overtime gradually increased throughout her training
period, peaking at Week 20 where she ran 70.28 km over the course of the
week. Weeks 21-25 demonstrate a steep drop in weekly mileage. This was
due to Emma’s illnesses and injuries, making her unable to run. The plot
above demonstrates Emma’s ramp up in training mileage in preparation for
the NYCM.</p>
</div>
<div id="mileage-density-plot" class="section level3">
<h3>Mileage Density Plot</h3>
<pre class="r"><code>tidy_training %&gt;% 
  ggplot(aes(x = distance_km), color = c(&quot;#FFA500&quot;)) +
  geom_density(alpha = 0.5, fill = c(&quot;#FFA500&quot;)) + 
  labs(
    title = &quot;Density of Daily Distances Ran by Emma (km)&quot;,
    x = &quot;Distance (km)&quot;, 
    y = &quot;Density&quot;) + 
  scale_x_continuous(breaks = scales::pretty_breaks(n = 5)) + 
  scale_y_continuous(breaks = scales::pretty_breaks(n = 5)) +
  theme(axis.line = element_line(color = &quot;grey&quot;), 
        panel.background = element_blank(), 
        legend.position = &quot;none&quot;, 
        panel.grid.major = element_line(color = &quot;light grey&quot;, linetype = &quot;dashed&quot;),
        plot.title = element_text(hjust = 0.5))</code></pre>
<p><img src="backup_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>The density plot above illustrates the mileage at which Emma run’s
most often during her training period. The plot peaks at a distance of
approximately 7km, indicating that 7km is the length of most of Emma’s
runs during her training period.</p>
</div>
<div id="performance-vs.-temperature" class="section level3">
<h3>Performance vs. Temperature</h3>
<pre class="r"><code>temp_avg_speed = 
  tidy_training %&gt;% 
  ggplot(aes(x = weather_temperature, y = average_speed)) + 
  geom_point(color = c(&quot;#FFA500&quot;)) +
  geom_smooth(se = FALSE, color = &quot;dark grey&quot;) + 
    labs(
    x = &quot;Temperature (C)&quot;, 
    y = &quot;Average Speed (m/s)&quot;) + 
  scale_x_continuous(breaks = scales::pretty_breaks(n = 5)) + 
  scale_y_continuous(breaks = scales::pretty_breaks(n = 5)) +
  theme(axis.line = element_line(color = &quot;grey&quot;), 
        panel.background = element_blank(), 
        legend.position = &quot;none&quot;, 
        panel.grid.major = element_line(color = &quot;light grey&quot;, linetype = &quot;dashed&quot;),
        plot.title = element_text(hjust = 0.5)) + 
  ggtitle(&quot;Temperature (C) vs. Emma&#39;s Average Speed (m/s)&quot;)

temp_avg_hrt = 
  tidy_training %&gt;% 
  ggplot(aes(x = weather_temperature, y = average_heart_rate)) + 
  geom_point(color = c(&quot;#FFA500&quot;)) +
  geom_smooth(se = FALSE, color = &quot;dark grey&quot;) + 
    labs(
    x = &quot;Temperature (C)&quot;, 
    y = &quot;Average Heart Rate (BPM)&quot;) + 
  scale_x_continuous(breaks = scales::pretty_breaks(n = 5)) + 
  scale_y_continuous(breaks = scales::pretty_breaks(n = 5)) +
  theme(axis.line = element_line(color = &quot;grey&quot;), 
        panel.background = element_blank(), 
        legend.position = &quot;none&quot;, 
        panel.grid.major = element_line(color = &quot;light grey&quot;, linetype = &quot;dashed&quot;),
        plot.title = element_text(hjust = 0.5)) + 
  ggtitle(&quot;Temperature (C) vs.\n Emma&#39;s Average Heart Rate (BPM)&quot;)

temp_rel_effort = 
  tidy_training %&gt;% 
  ggplot(aes(x = weather_temperature, y = relative_effort)) + 
  geom_point(color = c(&quot;#FFA500&quot;)) +
  geom_smooth(se = FALSE, color = &quot;dark grey&quot;) + 
    labs(
    x = &quot;Temperature (C)&quot;, 
    y = &quot;Relative Effort&quot;) + 
  scale_x_continuous(breaks = scales::pretty_breaks(n = 5)) + 
  scale_y_continuous(breaks = scales::pretty_breaks(n = 5)) +
  theme(axis.line = element_line(color = &quot;grey&quot;), 
        panel.background = element_blank(), 
        legend.position = &quot;none&quot;, 
        panel.grid.major = element_line(color = &quot;light grey&quot;, linetype = &quot;dashed&quot;),
        plot.title = element_text(hjust = 0.5)) + 
  ggtitle(&quot;Temperature (C) vs.\n Emma&#39;s Relative Effort&quot;)

temp_avg_speed /
(temp_avg_hrt | temp_rel_effort)</code></pre>
<p><img src="backup_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Although we expected Emma’s speed to be inversely proportional to the
weather temperature, Emma’s average speed stayed approximately steady
throughout the training period, with a speed of 3 meters per second
(10.8 km per hour), while temperature varied between 6.58 degrees
Celsius and 27.89 degrees Celsius.</p>
<p>Additionally, while we hypothesized that external temperature would
be directly related to Emma’s average heart rate, the plot on the bottom
left demonstrates that as temperature increases, there is little
noticeable change in Emma’s average heart rate. Daily temperatures
varied between 6.58 degrees Celsius and 27.89 degrees Celsius and Emma’s
heart rate averaged around 155 beats per minute.</p>
<p>Finally, we also hypothesized that external temperature would be
directly related to Emma’s relative effort; however, the plot on the
bottom right demonstrates that external temperature and Emma’s relative
effort do not appear to be correlated. The variable
<code>relative_effort</code> is calculated by Strava and based off of
her maximum heart rate and pre-established heart rate zones. The plot
demonstrates that while temperature varied between 6.58 degrees Celsius
and 27.89 degrees Celsius, Emma’s relative effort averaged around
150.</p>
</div>
<div id="performance-vs.-humidity" class="section level3">
<h3>Performance vs. Humidity</h3>
<pre class="r"><code>humid_avg_speed = 
  tidy_training %&gt;% 
  ggplot(aes(x = humidity*100, y = average_speed)) + 
  geom_point(color = c(&quot;#FFA500&quot;)) +
  geom_smooth(se = FALSE, color = &quot;dark grey&quot;) + 
    labs(
    x = &quot;Humidity (%)&quot;, 
    y = &quot;Average Speed (m/s)&quot;) + 
  scale_x_continuous(breaks = scales::pretty_breaks(n = 5)) + 
  scale_y_continuous(breaks = scales::pretty_breaks(n = 5)) +
  theme(axis.line = element_line(color = &quot;grey&quot;), 
        panel.background = element_blank(), 
        legend.position = &quot;none&quot;, 
        panel.grid.major = element_line(color = &quot;light grey&quot;, linetype = &quot;dashed&quot;),
        plot.title = element_text(hjust = 0.5)) + 
  ggtitle(&quot;Humidity (%) vs. Emma&#39;s Average Speed (m/s)&quot;)

humid_avg_hrt = 
  tidy_training %&gt;% 
  ggplot(aes(x = humidity*100, y = average_heart_rate)) + 
  geom_point(color = c(&quot;#FFA500&quot;)) +
  geom_smooth(se = FALSE, color = &quot;dark grey&quot;) + 
    labs(
    x = &quot;Humidity (%)&quot;, 
    y = &quot;Average Heart Rate (BPM)&quot;) + 
  scale_x_continuous(breaks = scales::pretty_breaks(n = 5)) + 
  scale_y_continuous(breaks = scales::pretty_breaks(n = 5)) +
  theme(axis.line = element_line(color = &quot;grey&quot;), 
        panel.background = element_blank(), 
        legend.position = &quot;none&quot;, 
        panel.grid.major = element_line(color = &quot;light grey&quot;, linetype = &quot;dashed&quot;),
        plot.title = element_text(hjust = 0.5)) + 
  ggtitle(&quot;Humidity (%) vs.\n Emma&#39;s Average Heart Rate (BPM)&quot;)

humid_rel_effort = 
  tidy_training %&gt;% 
  ggplot(aes(x = humidity*100, y = relative_effort)) + 
  geom_point(color = c(&quot;#FFA500&quot;)) +
  geom_smooth(se = FALSE, color = &quot;dark grey&quot;) + 
    labs(
    x = &quot;Humidity (%)&quot;, 
    y = &quot;Relative Effort&quot;) + 
  scale_x_continuous(breaks = scales::pretty_breaks(n = 5)) + 
  scale_y_continuous(breaks = scales::pretty_breaks(n = 5)) +
  theme(axis.line = element_line(color = &quot;grey&quot;), 
        panel.background = element_blank(), 
        legend.position = &quot;none&quot;, 
        panel.grid.major = element_line(color = &quot;light grey&quot;, linetype = &quot;dashed&quot;),
        plot.title = element_text(hjust = 0.5)) + 
  ggtitle(&quot;Humidity (%) vs.\n Emma&#39;s Relative Effort&quot;)

humid_avg_speed /
(humid_avg_hrt | humid_rel_effort)</code></pre>
<p><img src="backup_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Although we expected Emma’s speed to be inversely related to the
external humidity, Emma’s average speed stayed approximately steady
throughout the training period, with a speed of 3 meters per second
(10.8 km per hour), while humidity varied between between 32% and 96%,
as demonstrated in the top plot above.</p>
<p>Additionally, while we hypothesized that external humidity would be
directly related to Emma’s average heart rate, the plot on the bottom
left demonstrates that there is a potential positive relationship
between humidity and Emma’s average heart rate. Humidity varied between
32% and 96% and Emma’s average heart rate ranged between 145 to 165
beats per minute.</p>
<p>Finally, although we hypothesized that external humidity would be
directly related to Emma’s relative effort, the plot on the bottom right
demonstrates that relative effort may plateau at 150 once humidity
reaches 70%; however, there is a large degree of variation in relative
effort in this data set. The variable relative effort is calculated by
Strava and based off of her heart rate during the training session.
While humidity varied between 32% and 96%, Emma’s relative effort
averaged around 150.</p>
</div>
<div id="interactive-marathon-route-map" class="section level3">
<h3>Interactive Marathon Route Map</h3>
<pre class="r"><code>marathon_day &lt;- read_csv(&quot;activities/marathon_day.csv&quot;)

marathon_day =
marathon_day %&gt;% 
mutate(
  distance_m = distance*0.000621371
) %&gt;% 
mutate(group = case_when(
    between(distance_m, 0,0.9999) ~ &quot;Start&quot;,
    between(distance_m, 1, 1.9999) ~ &quot;1&quot;,
    between(distance_m, 2, 2.9999) ~ &quot;2&quot;,
    between(distance_m, 3, 3.9999) ~ &quot;3&quot;,
    between(distance_m, 4, 4.9999) ~ &quot;4&quot;,
    between(distance_m, 5, 5.9999) ~ &quot;5&quot;,
    between(distance_m, 6, 6.9999) ~ &quot;6&quot;,
    between(distance_m, 7, 7.9999) ~ &quot;7&quot;,
    between(distance_m, 8, 8.9999) ~ &quot;8&quot;,
    between(distance_m, 9, 9.9999) ~ &quot;9&quot;,
    between(distance_m, 10, 10.9999) ~ &quot;10&quot;,
    between(distance_m, 11, 11.9999) ~ &quot;11&quot;,
    between(distance_m, 12, 12.9999) ~ &quot;12&quot;,
    between(distance_m, 13, 13.9999) ~ &quot;13&quot;,
    between(distance_m, 14, 14.9999) ~ &quot;14&quot;,
    between(distance_m, 15, 15.9999) ~ &quot;15&quot;,
    between(distance_m, 16, 2.9999) ~ &quot;16&quot;,
    between(distance_m, 17, 17.9999) ~ &quot;17&quot;,
    between(distance_m, 18, 18.9999) ~ &quot;18&quot;,
    between(distance_m, 19, 19.9999) ~ &quot;19&quot;,
    between(distance_m, 20, 20.9999) ~ &quot;20&quot;,
    between(distance_m, 21, 21.9999) ~ &quot;21&quot;,
    between(distance_m, 22, 22.9999) ~ &quot;22&quot;,
    between(distance_m, 23, 23.9999) ~ &quot;23&quot;,
    between(distance_m, 24, 24.9999) ~ &quot;24&quot;,
    between(distance_m, 25, 25.9999) ~ &quot;25&quot;,
    between(distance_m, 26, 26.9999) ~ &quot;26-Finish&quot;)) 

#Recode
marathon_geo =
  marathon_day %&gt;% 
  mutate(
    latitude  = position_lat,
    longitude = position_long) %&gt;% 
  select(-position_lat, -position_long)

marathon_speed =
marathon_geo %&gt;% 
  group_by(group) %&gt;% 
  mutate(
    speed_mile = 
  enhanced_speed*2.237)

#Aggregate Data
agg = aggregate(marathon_speed,
                by = list(marathon_geo$group),
                FUN = mean)</code></pre>
<p>In order to display Emma’s progress throughout the NYC Marathon an
interactive map was created. Utilizing data from the ‘marathon_day’ data
set, cleaning began with converting the distance measurement from
kilometers to miles, in order to best display the race. From this, each
observation was grouped by mileage (1-26), with a Start (Mile 0) and
Finish (Mile 26.6) observation being added as well. Variables
‘position_longitude’ and ‘position_latitude’ were recoded to ‘longitude’
and ‘latitude’ within the data set. A new data set ‘marathon_speed’ was
generated in order to group all observations based on mile as well as
convert speed from its initial unit of meters per second to miles per
hour. The data was then aggregated in order to create averages for each
of Emma’s mile statistics such as Speed, Heart Rate, Cadence, as well as
Altitude. Leaflet was then used to display all mile markers along the
26.6 Mile route, in addition to a pop-up that includes Emma’s summary
statistics for each running stint of the marathon.</p>
<pre class="r"><code>leaflet() %&gt;% 
  addTiles() %&gt;% 
  addCircleMarkers(data = agg,
             lng = ~longitude,
             lat = ~latitude,
             label = ~Group.1,
             radius = 7,
             color = &quot;orange&quot;,
             stroke = TRUE, fillOpacity = 0.75,
             popup = ~paste(&quot;Mile:&quot;, Group.1,
                            &quot;&lt;br&gt;Speed:&quot;, speed_mile,
                            &quot;&lt;br&gt;HR:&quot;, heart_rate,
                             &quot;&lt;br&gt;Cadence:&quot;, cadence,
                            &quot;&lt;br&gt;Altitude:&quot;, enhanced_altitude)) %&gt;% 
  addProviderTiles(providers$CartoDB.Positron)</code></pre>
<div id="htmlwidget-4789d027c24110a12cb6" style="width:672px;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-4789d027c24110a12cb6">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"https://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addCircleMarkers","args":[[40.6104348705628,40.7042159239592,40.7164656348145,40.728277819874,40.740826228118,40.7491534880795,40.7558571904419,40.7777123779879,40.7903228550433,40.8023561141454,40.6192627834549,40.8118997489457,40.8102504578455,40.8001325806757,40.7882020822061,40.7763461387941,40.766959590201,40.770384692587,null,40.6444014760309,40.6557787290627,40.6671305434582,40.6794894834151,40.6876716191673,40.6921380146503,40.6043989839213],[-74.0346232919979,-73.9608535200188,-73.9589246148317,-73.9524508345938,-73.9525773309703,-73.9450712946021,-73.9528505667326,-73.9487948260759,-73.939629788009,-73.9298666665563,-74.0288426203294,-73.928230043045,-73.9394263029525,-73.9473303446644,-73.9557053759358,-73.966941702771,-73.9756988926056,-73.9788563751305,null,-74.0148388704929,-74.0029969833497,-73.9916699058621,-73.9818277620092,-73.9710569978992,-73.9571167532644,-74.0517789316213],7,null,null,{"interactive":true,"className":"","stroke":true,"color":"orange","weight":5,"opacity":0.5,"fill":true,"fillColor":"orange","fillOpacity":0.75},null,null,["Mile: 1 <br>Speed: 7.16634034234234 <br>HR: 169.648648648649 <br>Cadence: 79.945945945946 <br>Altitude: 55.3783783783784","Mile: 10 <br>Speed: 5.91045904545455 <br>HR: 173.840909090909 <br>Cadence: 78.7045454545455 <br>Altitude: 33.7590909090909","Mile: 11 <br>Speed: 6.16624646456693 <br>HR: 177.094488188976 <br>Cadence: 82.5984251968504 <br>Altitude: 16.0708661417323","Mile: 12 <br>Speed: 6.49777232743363 <br>HR: 177.964601769911 <br>Cadence: 80.9469026548673 <br>Altitude: 18.8495575221239","Mile: 13 <br>Speed: 6.69400279464286 <br>HR: 178.732142857143 <br>Cadence: 82.5803571428571 <br>Altitude: 12.6339285714286","Mile: 14 <br>Speed: 5.6681484084507 <br>HR: 176.633802816901 <br>Cadence: 82.3943661971831 <br>Altitude: 32.8197183098592","Mile: 15 <br>Speed: 3.31547001376147 <br>HR: 139.56880733945 <br>Cadence: 79.0596330275229 <br>Altitude: 24.3201834862385","Mile: 17 <br>Speed: 6.22130553389831 <br>HR: 171.686440677966 <br>Cadence: 82.7966101694915 <br>Altitude: 42.0186440677966","Mile: 18 <br>Speed: 5.64340035384615 <br>HR: 150.307692307692 <br>Cadence: 72.3923076923077 <br>Altitude: 23.2507692307692","Mile: 19 <br>Speed: 5.27883065625 <br>HR: 145.89375 <br>Cadence: 71.54375 <br>Altitude: 24.7425","Mile: 2 <br>Speed: 6.9439558440367 <br>HR: 173 <br>Cadence: 80.8623853211009 <br>Altitude: 28.9633027522936","Mile: 20 <br>Speed: 5.93609676258993 <br>HR: 160.647482014388 <br>Cadence: 81.4244604316547 <br>Altitude: 13.6474820143885","Mile: 21 <br>Speed: 6.25834048854962 <br>HR: 159.206106870229 <br>Cadence: 81.8015267175573 <br>Altitude: 27.1435114503817","Mile: 22 <br>Speed: 5.80403946616541 <br>HR: 167.353383458647 <br>Cadence: 80.4586466165414 <br>Altitude: 46.0736842105263","Mile: 23 <br>Speed: 5.55055204511278 <br>HR: 172.233082706767 <br>Cadence: 76.6842105263158 <br>Altitude: 73.8285714285714","Mile: 24 <br>Speed: 5.43006440875912 <br>HR: 173.737226277372 <br>Cadence: 71.2116788321168 <br>Altitude: 26.043795620438","Mile: 25 <br>Speed: 5.92434019254658 <br>HR: 176.484472049689 <br>Cadence: 80.0683229813665 <br>Altitude: 7.53540372670807","Mile: 26-Finish <br>Speed: 6.85462368518519 <br>HR: 183.296296296296 <br>Cadence: 86.1481481481482 <br>Altitude: 19.3185185185185","Mile: 3 <br>Speed: NA <br>HR: 174.938053097345 <br>Cadence: 80.4070796460177 <br>Altitude: 33.7256637168142","Mile: 4 <br>Speed: 6.94028204672897 <br>HR: 175.383177570093 <br>Cadence: 80.4485981308411 <br>Altitude: 27.985046728972","Mile: 5 <br>Speed: 6.79859621052632 <br>HR: 172.69298245614 <br>Cadence: 81.3245614035088 <br>Altitude: 14.8368421052632","Mile: 6 <br>Speed: 6.84808492982456 <br>HR: 175.333333333333 <br>Cadence: 81.780701754386 <br>Altitude: 26.0666666666667","Mile: 7 <br>Speed: 6.65007464705882 <br>HR: 175.352941176471 <br>Cadence: 79.4705882352941 <br>Altitude: 22.6436974789916","Mile: 8 <br>Speed: 6.82514246280992 <br>HR: 177.280991735537 <br>Cadence: 81.7851239669422 <br>Altitude: 42.1074380165289","Mile: 9 <br>Speed: 6.75896050862069 <br>HR: 177.534482758621 <br>Cadence: 82.5948275862069 <br>Altitude: 37.3586206896552","Mile: Start <br>Speed: 6.53191371774194 <br>HR: 168.548387096774 <br>Cadence: 80.9112903225806 <br>Altitude: 68.2774193548387"],null,["1","10","11","12","13","14","15","17","18","19","2","20","21","22","23","24","25","26-Finish","3","4","5","6","7","8","9","Start"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addProviderTiles","args":["CartoDB.Positron",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]}],"limits":{"lat":[40.6043989839213,40.8118997489457],"lng":[-74.0517789316213,-73.928230043045]}},"evals":[],"jsHooks":[]}</script>
<p>The leaflet plot above demonstrates Emma’s NYCM racing path. Each
marker indicates the mile number and average speed (miles/hour), heart
rate, cadence, and altitude for that mile. As a note, Strava failed to
record information for Mile 3, and is therefore not included in the
leaflet above.</p>
<p><br/></p>
</div>
</div>
<div id="additional-analysis" class="section level2">
<h2>Additional Analysis</h2>
<div id="speed-regression-models" class="section level3">
<h3>Speed Regression Models</h3>
<p>Based on Emma’s recount of personal experience, she perceives
environmental factors to be significant predictors of her performance.
More specifically, weather conditions such as temperature, humidity,
dewpoint, and windspeed affect Emma’s perceived running experience.
Additionally, due to the irregular environmental conditions on race day,
we generated several models to investigate which environmental factors
would be best predictors for Emma’s performance. We hypothesize that
Emma’s average speed is dependent on temperature. To test this
hypothesis, we built the following models:</p>
<ul>
<li>Average speed vs temperature</li>
<li>Average speed vs dew point</li>
<li>Average speed vs humidity</li>
<li>Average speed vs elevation gain and wind speed, and all
interactions</li>
<li>Average speed vs temperature and dew point, and all
interactions</li>
</ul>
<pre class="r"><code>fit1 = lm(average_speed ~ weather_temperature, data = tidy_training)
fit2 = lm(average_speed ~ dewpoint, data = tidy_training)
fit3 = lm(average_speed ~ humidity, data = tidy_training)
fit4 = lm(average_speed ~ (elevation_gain + wind_speed)^3, data = tidy_training)
fit5 = lm(average_speed ~ (weather_temperature + dewpoint)^3, data = tidy_training)</code></pre>
</div>
<div id="cross-validation-speed" class="section level3">
<h3>Cross-Validation: Speed</h3>
<p>We can now perform a comparison between the five models in terms of
cross-validated prediction error. To do this, we first create a
cross-validation data frame <code>cv_df</code>. Contained within
<code>cv_df</code> is 2 side-by-side list columns with the testing and
training data split pairs, with a corresponding ID number for each pair.
Since we are able to apply resample objects directly into
<code>lm</code> functions, we can skip the extra step of converting the
testing and training data into tibbles. Next, we apply the
<code>map</code> function to map each regression model to the training
data. Finally, we can compute the root mean squared errors (RMSEs) for
each model by applying the <code>map2_dbl</code> function to the testing
data.</p>
<pre class="r"><code>cv_df = 
  crossv_mc(tidy_training, 100)

cv_df = cv_df %&gt;% 
  mutate(
    mod1 = map(.x = train, ~lm(average_speed ~ weather_temperature, data = .x)), 
    mod2 = map(.x = train, ~lm(average_speed ~ dewpoint, data = .x)), 
    mod3 = map(.x = train, ~lm(average_speed ~ humidity, data = .x)), 
    mod4 = map(.x = train, ~lm(average_speed ~ (elevation_gain + wind_speed)^3, data = .x)),
    mod5 = map(.x = train, ~lm(average_speed ~ (weather_temperature + dewpoint)^3, data = .x))) %&gt;% 
  mutate(
    rmse_mod1 = map2_dbl(.x = mod1, .y = test, ~rmse(model = .x, data = .y)), 
    rmse_mod2 = map2_dbl(.x = mod2, .y = test, ~rmse(model = .x, data = .y)), 
    rmse_mod3 = map2_dbl(.x = mod3, .y = test, ~rmse(model = .x, data = .y)),
    rmse_mod4 = map2_dbl(.x = mod4, .y = test, ~rmse(model = .x, data = .y)),
    rmse_mod5 = map2_dbl(.x = mod5, .y = test, ~rmse(model = .x, data = .y)))

cv_df %&gt;% 
  select(starts_with(&quot;rmse&quot;)) %&gt;% 
  pivot_longer(
    everything(), 
    names_to = &quot;model&quot;, 
    values_to = &quot;rmse&quot;, 
    names_prefix = &quot;rmse_&quot;) %&gt;% 
  ggplot(aes(x = model, y = rmse, color = c(&quot;#FFA500&quot;))) +
  geom_boxplot(color = c(&quot;#FFA500&quot;)) + 
  labs(
    title = &quot;Root Mean Squared Errors Distributions for Emma&#39;s Average Speed&quot;, 
    x = &quot;Fitted Model&quot;, 
    y = &quot;RMSE&quot;)  + 
  theme(axis.line = element_line(color = &quot;grey&quot;), 
        panel.background = element_blank(), 
        legend.position = &quot;none&quot;, 
        panel.grid.major = element_line(color = &quot;light grey&quot;, linetype = &quot;dashed&quot;),
        plot.title = element_text(hjust = 0.5)) +
  scale_x_discrete(labels = c(&quot;mod1&quot; = &quot;Temperature Model&quot;, 
                              &quot;mod2&quot; = &quot;Dewpoint Model&quot;, 
                              &quot;mod3&quot; = &quot;Humidity Model&quot;,
                              &quot;mod4&quot; = &quot;Elevation, Wind, \n Interactions&quot;,
                              &quot;mod5&quot; = &quot;Temperature, Dewpoint, \n Interactions&quot;))</code></pre>
<p><img src="backup_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<pre class="r"><code>summary(fit1) %&gt;% 
  broom::tidy() %&gt;% 
  filter(term == &quot;weather_temperature&quot;) %&gt;% 
  mutate(
    lower_ci = exp(estimate - 1.96*std.error),
    upper_ci = exp(estimate + 1.96*std.error)
  ) %&gt;% 
  select(term, estimate, lower_ci, upper_ci, p.value) %&gt;% 
  knitr::kable(digits = 3, 
               col.names = c(&quot;Term&quot;, &quot;Estimate&quot;, &quot;Lower CI&quot;, &quot;Upper CI&quot;, &quot;P-value&quot;))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Term</th>
<th align="right">Estimate</th>
<th align="right">Lower CI</th>
<th align="right">Upper CI</th>
<th align="right">P-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">weather_temperature</td>
<td align="right">0.011</td>
<td align="right">1.001</td>
<td align="right">1.021</td>
<td align="right">0.031</td>
</tr>
</tbody>
</table>
<p>Based on the distributions depicted above, we can conclude that the
model with temperature is able to generate better predictions than the
other models with environmental factors. The p-value for this model is
0.03101. As it is below the significance level of 0.05, we can conclude
that this model is a good predictor for average speed.</p>
</div>
<div id="relative-effort-regression-models" class="section level3">
<h3>Relative Effort Regression Models</h3>
<p>Additionally, we hypothesize that Emma’s relative effort is dependent
on temperature. To test this hypothesis, we built the following
models:</p>
<ul>
<li>Relative effort vs temperature</li>
<li>Relative effort vs dewpoint</li>
<li>Relative effort vs humidity</li>
<li>Relative effort vs elevation gain and wind speed, and all
interactions</li>
<li>Relative effort vs temperature and dewpoint, and all
interactions</li>
</ul>
<pre class="r"><code>fit1 = lm(relative_effort ~ weather_temperature, data = tidy_training)
fit2 = lm(relative_effort ~ dewpoint, data = tidy_training)
fit3 = lm(relative_effort ~ humidity, data = tidy_training)
fit4 = lm(relative_effort ~ (elevation_gain + wind_speed)^3, data = tidy_training)
fit5 = lm(relative_effort ~ (weather_temperature + dewpoint + humidity)^4, data = tidy_training)</code></pre>
</div>
<div id="cross-validation-relative-effort" class="section level3">
<h3>Cross-Validation: Relative Effort</h3>
<p>We followed the same cross validation process as above.</p>
<pre class="r"><code>cv_df = 
  crossv_mc(tidy_training, 100)

cv_df = cv_df %&gt;% 
  mutate(
    mod1 = map(.x = train, ~lm(relative_effort ~ weather_temperature, data = .x)), 
    mod2 = map(.x = train, ~lm(relative_effort ~ dewpoint, data = .x)), 
    mod3 = map(.x = train, ~lm(relative_effort ~ humidity, data = .x)), 
    mod4 = map(.x = train, ~lm(relative_effort ~ (elevation_gain + wind_speed)^3, data = .x)),
    mod5 = map(.x = train, ~lm(relative_effort ~ (weather_temperature + dewpoint + humidity)^4, data = .x))) %&gt;% 
  mutate(
    rmse_mod1 = map2_dbl(.x = mod1, .y = test, ~rmse(model = .x, data = .y)), 
    rmse_mod2 = map2_dbl(.x = mod2, .y = test, ~rmse(model = .x, data = .y)), 
    rmse_mod3 = map2_dbl(.x = mod3, .y = test, ~rmse(model = .x, data = .y)),
    rmse_mod4 = map2_dbl(.x = mod4, .y = test, ~rmse(model = .x, data = .y)),
    rmse_mod5 = map2_dbl(.x = mod5, .y = test, ~rmse(model = .x, data = .y)))

cv_df %&gt;% 
  select(starts_with(&quot;rmse&quot;)) %&gt;% 
  pivot_longer(
    everything(), 
    names_to = &quot;model&quot;, 
    values_to = &quot;rmse&quot;, 
    names_prefix = &quot;rmse_&quot;) %&gt;% 
  ggplot(aes(x = model, y = rmse, color = c(&quot;#FFA500&quot;))) +
  geom_boxplot(color = c(&quot;#FFA500&quot;)) + 
  labs(
    title = &quot;Root Mean Squared Errors Distributions for Emma&#39;s Relative Effort&quot;, 
    x = &quot;Fitted Model&quot;, 
    y = &quot;RMSE&quot;)  + 
  theme(axis.line = element_line(color = &quot;grey&quot;), 
        panel.background = element_blank(), 
        legend.position = &quot;none&quot;, 
        panel.grid.major = element_line(color = &quot;light grey&quot;, linetype = &quot;dashed&quot;),
        plot.title = element_text(hjust = 0.5)) +
  scale_x_discrete(labels = c(&quot;mod1&quot; = &quot;Temperature Model&quot;, 
                              &quot;mod2&quot; = &quot;Dewpoint Model&quot;, 
                              &quot;mod3&quot; = &quot;Humidity Model&quot;,
                              &quot;mod4&quot; = &quot;Elevation, Wind, \n Interactions&quot;,
                              &quot;mod5&quot; = &quot;Temperature, Dewpoint, \n Humidity, Interactions&quot;))</code></pre>
<p><img src="backup_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<pre class="r"><code>summary(fit4) %&gt;%
  broom::tidy() %&gt;%
  filter(term != &quot;(Intercept)&quot;) %&gt;%
  mutate(
    lower_ci = exp(estimate - 1.96*std.error),
    upper_ci = exp(estimate + 1.96*std.error)
  ) %&gt;%
  select(term, estimate, lower_ci, upper_ci, p.value) %&gt;%
  knitr::kable(digits = 3,
               col.names = c(&quot;Term&quot;, &quot;Estimate&quot;, &quot;Lower CI&quot;, &quot;Upper CI&quot;, &quot;P-value&quot;))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Term</th>
<th align="right">Estimate</th>
<th align="right">Lower CI</th>
<th align="right">Upper CI</th>
<th align="right">P-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">elevation_gain</td>
<td align="right">1.069</td>
<td align="right">1.776</td>
<td align="right">4.776</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">wind_speed</td>
<td align="right">-15.865</td>
<td align="right">0.000</td>
<td align="right">0.531</td>
<td align="right">0.044</td>
</tr>
<tr class="odd">
<td align="left">elevation_gain:wind_speed</td>
<td align="right">0.199</td>
<td align="right">1.047</td>
<td align="right">1.424</td>
<td align="right">0.013</td>
</tr>
</tbody>
</table>
<p>Based on the distributions depicted above, we can conclude that the
model with elevation, wind, and interactions is able to generate better
predictions than the other models with environmental factors. The
p-value for this model is &lt; 2.2 e-16. As it is below the significance
level, we can conclude that this model is a good predictor for average
speed.</p>
<p><br/></p>
</div>
</div>
<div id="discussion" class="section level2">
<h2>Discussion</h2>
<p>Our analysis sought to analyze the impact of external factors, such
as temperature, wind, elevation, etc., on Emma’s speed and performance
during the NYC Marathon, while also considering how training changed
over time in order to improve her training for the next marathon.</p>
<p>To investigate the impact of these external factors, we created a
series of plots demonstrating the relationship between external
temperature and humidity with Emma’s average speed, heart rate, and
relative effort. We expected external temperature and humidity to be
inversely related with Emma’s average speed, heart rate, and relative
effort. However, the plots created demonstrated that while temperature
varied between 6.58˚C to 27.89˚C, Emma’s average speed, heart rate, and
relative effort remained relatively stable. Emma’s average speed was
approximately 3 meters/second throughout her training period. Her
average heart rate remained around 155 throughout her training period,
and her relative effort remained around 150. Similarly, the plots
created demonstrated that while humidity varied between 325 and 96%,
Emma’s average speed, heart rate, and relative effort remained
relatively stable. Although we had hypothesized that external
temperature and humidity would have a greater impact on Emma’s
performance throughout her training period, our analysis demonstrated
otherwise, indicating that Emma’s body is more resilient to external
factors than expected.</p>
<p>Additionally, from our prediction models, we can conclude that
temperature is a good predictor for average speed, with a p-value of
0.03101 and that elevation, wind, and is interactions are a good
predictor for relative effort, with a p-value of &lt;2.2 e-16. If Emma
integrates into her training varying temperature conditions in addition
to different elevation changes, this would help better prepare her for
her next marathon.</p>
<p>In preparation for Emma’s next marathon, this data analysis reveals
that it would be most effective to consider temperature and elevation of
her next marathon’s race course.</p>
<p>Go Emma!!!</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
